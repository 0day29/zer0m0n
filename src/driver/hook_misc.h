#ifndef __HOOK_MISC_H
#define __HOOK_MISC_H

/////////////////////////////////////////////////////////////////////////////
// GLOBALS
/////////////////////////////////////////////////////////////////////////////
typedef NTSTATUS(*NTCREATEMUTANT)(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,BOOLEAN);

NTCREATEMUTANT Orig_NtCreateMutant;


/////////////////////////////////////////////////////////////////////////////
// FUNCTIONS
/////////////////////////////////////////////////////////////////////////////
NTSTATUS Hooked_NtCreateMutant(__out PHANDLE MutantHandle,
							   __in ACCESS_MASK DesiredAccess,
							   __in_opt POBJECT_ATTRIBUTES ObjectAttributes,
							   __in BOOLEAN InitialOwner);

#endif